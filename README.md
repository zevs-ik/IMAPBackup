
# Email IMAP Backup Script

Этот скрипт предназначен для резервного копирования сообщений электронной почты старше 60 дней с сервера IMAP в локальные и сетевые папки. В формате EML.
Подключение к учетным данным происходит из файла email.csv

Этот скрипт **удаляет** обработанные сообщения с сервера IMAP после создания их резервных копий. Убедитесь, что это действительно то, что вы хотите делать, прежде чем запускать скрипт.
Закомментируйте эти строки в коде, чтобы письма не удалялись, например вот так:

```
# server.delete_messages(message_id)
```
```
# server.expunge()
```

## Установка

1. Установите Python 3.x с официального [сайта](https://www.python.org/downloads/).
2. Установите необходимые библиотеки с помощью pip:

```
pip install imapclient
```

## Настройка
Обновите переменные в скрипте, чтобы отразить вашу конфигурацию:

- `BACKUP_FOLDER`: локальный путь для сохранения резервных копий электронной почты.
- `NETWORK_BACKUP_FOLDER`: сетевой путь для сохранения резервных копий электронной почты.
- `IMAP_SERVER`: адрес сервера IMAP.
- `CSV_FILE_PATH`: путь к файлу CSV с данными учетных записей электронной почты.
- `DAYS_AGO`: количество дней, в течение которых будут сохраняться сообщения.

Подготовьте файл CSV с данными учетных записей электронной почты в следующем формате:
```
email;user;password
email@example.com;domain\user;Password
```
